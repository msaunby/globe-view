<html>
<head>
  <!--
  <script type="text/javascript" src="bower_components/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript" src="bower_components/threejs/build/three.min.js"></script>
  <script type="text/javascript" src="bower_components/threejs/examples/js/controls/TrackballControls.js"></script>
  -->
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script type="text/javascript" src="http://threejs.org/build/three.min.js"></script>
  <script type="text/javascript" src="http://threejs.org/examples/js/controls/TrackballControls.js"></script>
  <style>
  body {
    margin: 0px;
    background-color: #aaaaff;
    overflow: hidden;
  }
  </style>

  <script>
  var scene = new THREE.Scene();
  var width  = window.innerWidth,
  height = window.innerHeight;
  var camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 0);
  camera.position.y = 0;
  camera.position.z = 500;
  var controls = new THREE.TrackballControls(camera);

  var ambientLight = new THREE.AmbientLight( 0xffffff );
  scene.add( ambientLight );
  var renderer = new THREE.WebGLRenderer();
  renderer.setSize(width, height);

  function render() {
    controls.update();
    requestAnimationFrame(render);
    renderer.render(scene, camera);
  }

  var landTxtrParams = {
    request:'getmap',
    service:'wms',
    //BBOX:'-10.12,48.77,2.43,59.29',
    BBOX:'-180,-90,180,90',
    srs:'EPSG:4326',
    format:'image/jpeg',
    layers:'gebco_latest',
    width:2048,
    height:1024,
    version:'1.1.1'
  };

  var landTxtrUrl = 'http://www.gebco.net/' +
  'data_and_products/gebco_web_services/web_map_service/mapserv?';

  var basicMaterial;
  var geometry = new THREE.SphereGeometry( 100, 100, 100 );


  function loadWmsImage( url, params, cb ){
    var tmpImage = new Image();
    var wmsPng = url + jQuery.param( params );
    tmpImage.onload = function(){
      var canv = document.createElement('canvas');
      var ctx = canv.getContext('2d');
      canv.width = this.width;
      canv.height = this.height;
      ctx.drawImage(this, 0, 0);
      cb(canv.toDataURL());
    }
    tmpImage.crossOrigin = 'anonymous';
    tmpImage.src =  wmsPng;
  }

  function loadImage( url, cb ){
    var tmpImage = new Image();
    tmpImage.onload = function(){
      var canv = document.createElement('canvas');
      var ctx = canv.getContext('2d');
      canv.width = this.width - 24;
      canv.height = this.height - 24;
      ctx.drawImage(this, -12, -12);
      cb(canv.toDataURL());
    }
    tmpImage.crossOrigin = 'anonymous';
    tmpImage.src =  url;
  }

/*
  loadWmsImage( landTxtrUrl, landTxtrParams,
    function(img){
      wmsTexture = new THREE.ImageUtils.loadTexture(img);
      wmsTexture.needsUpdate = true;
      basicMaterial.map = wmsTexture;
      scene.add( plane );
      plane.updateMatrix();
    });
*/
  loadImage( 'images/max.png',
  function(img){
    wmsTexture = new THREE.ImageUtils.loadTexture(img);
    wmsTexture.needsUpdate = true;
    basicMaterial.map = wmsTexture;
    scene.add( plane );
    plane.updateMatrix();
  });

    basicMaterial = new THREE.MeshBasicMaterial( { overdraw: 1.0 } );

    var plane = new THREE.Mesh(	geometry, basicMaterial );
    //scene.add( plane );

    </script>
  </head>
  <body>
    <div id="webgl"></div>
    <script>
    document.getElementById('webgl').appendChild(renderer.domElement);
    render();
    </script>
  </body>
  </html>
